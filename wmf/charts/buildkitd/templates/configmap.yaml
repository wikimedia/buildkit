---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "buildkitd.fullname" . }}
  labels:
    {{- include "buildkitd.labels" . | nindent 4 }}
data:
  buildkitd.toml: |
    {{- .Values.buildkitdToml | nindent 4 }}
    {{- range .Values.insecureRegistries }}
    [registry.{{ . | quote }}]
      http = true
    {{- end }}
  {{- if .Values.cniConfig }}
  cni.json: |
    {{- .Values.cniConfig | mustToPrettyJson | nindent 4 }}
  {{- end }}
